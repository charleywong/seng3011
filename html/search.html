<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
</head>

<script src="./Chart.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $("#submitRequest").click(function(event){
      event.preventDefault();
      console.log($("#date").val());
      var parts = $("#date").val().split('-');
      var year = parts[0];
      var month = parts[1];
      var day = parts[2];
      var fixedDateFormat = month+"/"+day+"/"+year;

      console.log(fixedDateFormat);

      //add date
      var data = $('#searchForm').serializeArray();
      data.push({name:"DateOfInterest", value:fixedDateFormat});
      // serialize data
      data = $.param(data);

      var API_ENDPOINT = '/api/company_returns';
      console.log(data);

      // ajax call to get result
      $.getJSON(API_ENDPOINT, data, function(result){
        console.log("hello world");
        console.log(result);
        var items = [];
        $.each( result, function( key, val ) {
          items.push( "<li id='" + key + "'>" + val + "</li>" );
        });

        $( "<ul/>", {
          "class": "my-new-list",
          html: items.join( "" )
        }).appendTo( "body" );
      })
    });
});
</script>


<body>
<h1>Heading</h1>
<p>This is paragraph.</p>
<form id="searchForm"><!-- action="/api/company_returns"-->
  company code:
  <input type="text" name="InstrumentID" value="ABP.AX"> </br><!--need ajax here to help show possible results while typing-->
  upper window:
  <input type="text" name="UpperWindow" value="5"> </br>
  lower window:
  <input type="text" name="LowerWindow" value="3"> </br>

  Results for this date period:</br>
  <input type="checkbox" name="ListOfVar" value="CM_Return"> Cumulative Returns</br>
  <input type="checkbox" name="ListOfVar" value="AV_Return"> Average Returns</br>
</form>

date of interest:
<input type="date" id="date" name="DateOfInterest" value="2012-10-12"> </br>
<button id="submitRequest">Get Results</button>
<div id="result">
</div>

<canvas id="myChart" width="400" height="400"></canvas>
<script src="Chart.min.js"></script>
<script>
var ctx = document.getElementById("myChart");
var myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
        datasets: [
          {
          label: "My First dataset",
          fill: false,
          lineTension: 0.1,
          backgroundColor: "rgba(75,192,192,0.4)",
          borderColor: "rgba(75,192,192,1)",
          borderCapStyle: 'butt',
          borderDash: [],
          borderDashOffset: 0.0,
          borderJoinStyle: 'miter',
          pointBorderColor: "rgba(75,192,192,1)",
          pointBackgroundColor: "#fff",
          pointBorderWidth: 1,
          pointHoverRadius: 5,
          pointHoverBackgroundColor: "rgba(75,192,192,1)",
          pointHoverBorderColor: "rgba(220,220,220,1)",
          pointHoverBorderWidth: 2,
          pointRadius: 1,
          pointHitRadius: 10,
          data: [65, 59, 80, 81, 56, 55, 40],
          spanGaps: false,
        },
        {
          label: "Trend",
          fill: false,
          lineTension: 0.1,
          backgroundColor: "rgba(75,192,192,0.4)",
          borderColor: "rgba(75,192,192,1)",
          borderCapStyle: 'butt',
          borderDash: [],
          borderDashOffset: 0.0,
          borderJoinStyle: 'miter',
          pointBorderColor: "rgba(75,0,192,1)",
          pointBackgroundColor: "#fff",
          pointBorderWidth: 1,
          pointHoverRadius: 5,
          pointHoverBackgroundColor: "rgba(75,192,192,1)",
          pointHoverBorderColor: "rgba(220,220,220,1)",
          pointHoverBorderWidth: 2,
          pointRadius: 1,
          pointHitRadius: 10,
          data: [10, 50, 60, 101, 90, 80, 60],
          spanGaps: false,
        }
      ],
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
  }
  }
);
</script>
</body>
</html>
